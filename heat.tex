% This is a paper on the derivation of the heat conduction model with conservation-dissipation structure of irreversible thermodynamics
% Author:Huo Xiaokai Email:huoxiaokai_110@yeah.net
% First written on May 30. Changed in Sep 12,2014
% Revised on Sep 15.
%Revised on Sep 19
% Third version
\documentclass[a4paper]{article}
\usepackage{amsmath}
\usepackage{cite}
\title{A unified approach to heat transfer modeling through the conservation dissipation formalism of irreversible thermodynamics}
\author{Huo Xiaokai}
\date{Sep 19, 2014}
\begin{document}
\maketitle

\begin{abstract}
The conservation dissipation formalism of irreversible thermodynamics provides a new approach to model the heat transfer phenomena. The method begins with the entropy of the system and utilizes the stability criterion of non-equilibrium thermodynamics to get the relation between the conserved variables and the dissipative ones. Different from other methods, we assume the dissipative variables unknown and the relation between the dissipative variables and the conserved ones are obtained with the stability criterion. The arrived model is symmetric hyperbolic in mathematics and satisfies the second law of thermodynamics automatically. Some of the popular models in heat transfer are derived in our approach in the paper, including the Cattaneo's law, the thermomass model and the Guyer-Krumhansl's model. Our approach is flexible and paves a new way to think of the heat transfer modeling. 
\end{abstract}

\section{Introduction}
Recent years have seen an urge to develop an reasonable way to model the heat transfer phenomena in nano and micro systems \cite{chen2005nanoscale,tzou1996macro,wang2007heat,ding2006heat}. The heat transfer phenomena in the nano and mirco system are usually fast or in small scales. The Fourier's law and the Cattaneo's law are not enough to model the heat transfer phenomena in these systems \cite{chen2005nanoscale,Jou1996extended}. Various models have been developed such as the Guyer-Krumhansl's model \cite{guyer1966solution}, the thermomass model \cite{tzou2010nonlocal}, the ballistic-diffusive model \cite{chen2001ballistic,chen2002ballistic}, etc. Since the system is usually not in thermodynamics equilibrium, these models are usually obtained from the non-equilibrium thermodynamics. Different treatments of non-equilibrium thermodynamics have been proposed in the recent years, including the Classical Irreversible Thermodynamics (CIT) \cite{lebon2008classical}, the Extended Irreversible Thermodynamics (EIT) \cite{Jou1996extended}, the Rational Thermodynamics (RT) \cite{muller1998rational}, the GENERIC \cite{hans2005beyond}, the ThermoMass Theory \cite{zeng2006motion,dong2011generalized} and many more. CIT is based on the local equilibrium hypothesis. The fluxes variable are determined to be a function of the conserved variables and their spatial derivatives. EIT assumes the entropy is not only depended on the internal variable, like the internal energy $u$, but also on the flux variables like the heat flux $\mathbf{q}$ as well as its spatial derivatives. The equation obtained from CIT is usually second order parabolic, leading to an infinite propagating speed. EIT's evolution model is usually a system of first order hyperbolic equations. However, the hyperbolic equation is not guaranteed to be of conserved form and the well-posedness of the evolution equations needs further discussion\cite{Jou1996extended}. The Rational Extended Thermodynamics (RET) developed by \cite{liu2002rational,muller1998formal,Jou1996extended} introduce new enlarged state variables to describe the non-equilibrium and express the extended variable in functions of the classical state variables. The function is determined with the requirement of positive local entropy production. The equations obtained from RET is naturally of conservation form. However, the way of determining the function sometimes needs complex calculation. The thermomass theory is based on the Einstein's mass-energy equation. The flow of heat is similar as the flow of mass in the theory. The derived model is first order hyperbolic but the well-posedness of the equations is not clear.%\cite{zeng2006motion} 

Our aim of this paper is to provide a new way of heat transfer modeling which is physical insightful and mathematical reasonable. We provide a unified approach of heat transfer modeling with the conservation-dissipation formalism of non-equilibrium thermodynamics proposed by Yi Zhu, etc.\cite{zhu2014conservation} Similar with EIT, we begins with the entropy. Similar with RET, we introduce new dissipative variables to describe the non-equilibrium states. The new dissipative variables are used instead of the heat flux as the independent variable of the entropy. The relationship between the dissipative variables and the state variables is obtained based on the conservation-dissipative formalism of non-equilibrium thermodynamics. We arrived at a system of symmetric hyperbolic systems with the conservation-dissipation structure by Wen-An Yong \cite{yong2008interesting}. The equations are well-posed and have many good properties. For example, the  model will satisfy the second law of thermodynamics automatically. Our method is a combination of the CIT and RET method with a rigorous mathematical foundation. 


\subsection{The  heat transfer modeling with the conservation-dissipation formalism of irreversible thermodynamics}
The first law of thermodynamics gives the relation between the internal energy $u$ and the heat flux $\mathbf{q}$.
\begin{eqnarray}
u_t+\nabla \cdot \mathbf{q}=0
\end{eqnarray}

The classical Fourier's law for heat conduction is 
\begin{eqnarray}
\mathbf{q}_t=\lambda \nabla T
\end{eqnarray}
where $\mathbf{q}$ is the heat flux, $T$ is the temperature, and $\lambda$ is the heat conductivity. The model could be obtained with CIT in the following way.

The CIT makes the local equilibrium hypothesis of the system. The variables in the equilibrium thermodynamics remain significant and the entropy of the system is only related with these state variables. Assume the entropy of the system only depends on the internal energy $u$
\begin{eqnarray}
S=S(u)
\end{eqnarray}

Assume the entropy production could be expressed as 
\begin{eqnarray}
S_t=-\nabla \cdot \mathbf{J} + \sigma
\end{eqnarray}
where $\sigma$ is the local entropy production, $\mathbf{J}$ is the local entropy flux.
Then
\begin{eqnarray}
S_t=S_u u_t = -T^{-1} \nabla \cdot \mathbf{q} = -(T^{-1} \mathbf{q})+ \mathbf{q} \cdot \nabla T^{-1}
\end{eqnarray}
To guarantee the positiveness of the local entropy production, we take
\begin{eqnarray}
\mathbf{q}=\alpha \nabla T^{-1}
\end{eqnarray}
Taking $\alpha={\lambda}{T^2}$, one will recove the Fourier's law.

The Fourier's law is not valid in the small scales or in high frequencies. Fourier's law neglects the time needed for acceleration of the heat flow. In order to take the acceleration of heat flow into consideration, the Cattaneo's law was developed by Cattaneo \cite{cattaneo2011sulla}. The Cattaneo's law is 
\begin{eqnarray}
\tau \mathbf{q}_t = -(\mathbf{q}+\lambda \nabla T)
\end{eqnarray}
where $\tau$ is the relaxation time for the heat flux changing with the temperature.
From the book \cite{Jou1996extended}, the local entropy production of the Cattaneo's law is not positive with the CIT theory. It means that the entropy described with the equilibrium state variables does not follow the second law of thermodynamics. In order to overcome the problem, EIT introduces new variables like $\mathbf{q},\nabla \mathbf{q}$ as the dependent variables of the entropy. RET introduces a new variable $\mathbf{Q}$ as a unknown variable the entropy depends on and express it with the function of the equilibrium state variables and the heat flux. In both theories, The non-equilibrium entropy is not only depended on the equilibrium variables, but also on the non-equilibrium ones. And the non-equilibrium information of the system is contained in the form of the entropy. 

The system with Cattaneo's law could be written as
\begin{eqnarray}
\left( \begin{array}{ll} u \\ \mathbf{q} \end{array} \right)_t +\nabla \cdot \left( \begin{array}{ll} \mathbf{q} \\ \frac{\lambda}{\tau} T \mathbf{I} \end{array} \right) = \left( \begin{array}{ll} 0 \\ \frac{1}{\tau} \mathbf{q} \end{array} \right)
\end{eqnarray}
where $I$ is the unit tensor.

The system of equations are in the conservation-dissipation forms \cite{yong2008interesting}. The evolution equation for $\mathbf{q}$ takes the system into non-equilibrium states and the source for the $\mathbf{q}$ to be not in the local equilibrium  state is $\frac{\mathbf{q}}{\tau}$. If it's small the system will be in the local equilibrium state with the Fourier's law holds.
From this example, one could discover that the non-equilibrium states of the system is caused by the dissipation of the dissipative variables. So it's natural to introduce a new variable $w$ as the non-equilibrium variable as in RET. Include the varibale into the dependent variables of the entropy, and assume the evolution of the dissipative variable  is
\begin{eqnarray}
w_t+\nabla \phi(u,w)=v(u,w)
\end{eqnarray}

To make the system follows the conservation-dissipation formalism of irreversible thermodynamics, the entropy $S = S(u,w)$ should statisfies

1.(Symmetric Condition) There is a strictly concave function $S(u,w)$ such that $S_{UU} F_U(U)$ is symmetric for all $U=(u,w)$ under consideration.

2.(Stability Condition) There is a symmetric and positively definite matrix $M(U)$ such that $v(U)=M(U)S_c(U)$.

If the system satisfies these two conditions, we call it follows the conservation-dissipation structure. And we then have
\begin{equation}\label{entropyproduction}
S_t(U)+\nabla \cdot J(U)=S_c(U)M(U)S_c(U) \ge 0
\end{equation}
\eqref{entropyproduction} is actually the positive local entropy production condition which is a generalization of the second law of thermodynamics.

The  conservation-dissipation structure guarantees that the derived model satisfies the second law of thermodynamics automatically. And the derived equations are symmetric hyperbolic in conservation form. It's well-posed in mathematics\cite{friedrichs1971systems}. The equations have been studied by Wen-An Yong with details\cite{yong2008interesting,yong1999singular,kawashima2004dissipative}.


Based on the conservation-dissipation formalism of non-equilibrium thermodynamics, our approach will begins with the entropy $S$ and write the local entropy production as a function of the conserved variables and the dissipative ones. The key factor of our approach is to choose a positively definite matrix $M(U)$, to satisfy the stability condition. And in order to write the evolution equation using the internal variable and the heat flux, the relationship between the heat flux with the dissipative variables is suggested. 

We choose a new dissipative variable $w=\mathbf{c}$ and in order to satisfy the conservation-dissipation structure, the time derivative of $S$ could be written in the following form
\begin{equation}\label{St}
S_t=-\nabla \cdot J+\sigma
\end{equation}
We have
\begin{eqnarray}
S_t &=& S_u u_t + S_\mathbf{c} \cdot \mathbf{c}_t \\
 &=& -S_u \nabla \cdot \mathbf{q} +S_\mathbf{c} \cdot \mathbf{c}_t\\
&=& -\nabla \cdot(\mathbf{q}S_u)+S_\mathbf{c} \cdot \mathbf{c}_t+\mathbf{q} \cdot \nabla S_u
\end{eqnarray}

If we take $\mathbf{q}= S_\mathbf{c}$, we arrive at
\begin{equation}
S_t = -\nabla \cdot(\mathbf{q} S_u)+\mathbf{q} \cdot (\mathbf{c}_t+\nabla S_u)
\end{equation}
Note it's not necessary to take $\mathbf{q}=S_\mathbf{c}$. 

Compare to the local entropy production in the conservation-dissipative formalism, $S=S_c M S_c$, let
\begin{equation}
\mathbf{c}_t+ \nabla S_u=M(u,\mathbf{c}) \mathbf{q}
\end{equation}
where $M(u,\mathbf{c})$ is a positively definite matrix, one could get the evolution equation of the system
\begin{equation}
\left( \begin{array}{ll} u \\ \mathbf{c} \end{array} \right)_t + \nabla \cdot \left( \begin{array}{ll} \mathbf{q} \\ S_u \end{array} \right) = \left( \begin{array}{ll} 0 \\ M \mathbf{q} \end{array} \right)
\end{equation}
The local entropy production is
\begin{equation}
\sigma = S_c M S_c =\mathbf{q}^T M \mathbf{q}
\end{equation}

From the concavity of $S(u,\mathbf{c})$ and the relationship $\mathbf{q}=S_\mathbf{c}$, $\mathbf{c}$ could be expressed as a function of $\mathbf{q}$ and $u$ globally \cite{friedrichs1971systems}, we assume $\mathbf{c}=f(\mathbf{q},u)$ and we could obtain the evolution equation for $\mathbf{q}$
\begin{equation}
f(\mathbf{q},u)_t-\nabla S_u + M \mathbf{q} = 0
\end{equation}

If we define the non-equilibrium temperature $\theta$ as
\begin{equation}
\theta^{-1}=\frac{\partial S}{\partial u}
\end{equation}
we could get the evolution equation written with $\theta$
\begin{equation}
f(\mathbf{q},u)_t-\nabla \theta^{-1} + M \mathbf{q} = 0
\end{equation}

If we define the equilibrium temperature as
\begin{equation}
T^{-1} = \frac{\partial S_{eq}(u)}{\partial u}
\end{equation}
and then $S_u = g(T,c)$, the evolution equation for $\mathbf{q}$ could be written with $T$.
\begin{equation}
f(\mathbf{q},u)_t + \nabla g(T,c) + M \mathbf{q} = 0
\end{equation}
where $u=c_v T$, $c_v$ is the heat capacity ratio.

Note the equilibrium temperature and non-equilibrium temperature is defined in a different way. The internal energy is a function of the equilibrium temperature and the non-equilibrium temperature measures how far the system goes beyond equilibrium.

The flexible of our approach lies in the choose of the appropriate matrix $M(U)$ and the dissipative variables $\mathbf{c}$. The dissipative variable may not be a vector, it also could be a tensor or some vectors and tensors. 

The positive local entropy production is also needed for our approach like what was done in the EIT. However, we choose different dissipative variables from EIT. And all our derivation is based on the conservation-dissipation formalism of non-equilibrium thermodynamics. The stability condition is crucial for our development of the model. With the stability condition, the second law of thermodynamics is automatically followed. We introduce a new variable rather than assume the variable like $\mathbf{q},\nabla \mathbf{q}$ to measure how far the system goes away from equilibrium. We think it's more natural  since one has no idea what leads to non-equilibrium sometimes. Our method is fully non-linear. The matrix $M(U)$ could be any non-linear positively definite matrix, and the entropy could be defined in any concave form. We do not necessary take the form $S=S_{eq}+\delta S$ where $\delta S$ is small. We could abandon the local equilibrium hypothesis. Besides, the temperature in our approach is clear. $T$ is the temperature measuring the energy of the equilibrium state and $\theta$ is the temperature measuring the non-equilibrium entropy production caused by the dissipation.  

Actually our approach clarify the origin of the non-equilibrium state of the system. It's caused by the dissipative variables with the local entropy production. The system contains the conserved equations responsible for the law of energy conservation and the dissipative equations responsible for the non-equilibrium state. The system is thus included in a interesting class of partial differential equations which has been studied by \cite{yong2008interesting}. It's physical meaningful as well as mathematical reasonable.

\section{Apply to the heat conduction models}
The traditional Fourier's law for heat conduction is not adequate to describe the heat conduction at small scales and in high frequencies. Many models have developed during the past few years. Among them are the Cattaneo's law \cite{cattaneo2011sulla}, the Guyer-Krumhansl's law \cite{guyer1966solution}, the thermomass model \cite{zeng2006motion,dong2011generalized} and the ballistic-diffusive model \cite{chen2002ballistic,chen2001ballistic}. Here we derive the first three models with our approach and the ballistic-diffusive model will be discussed in the future. 

\subsection{The Cattaneo's law}

The Cattaneo's law was developed by Cattaneo \cite{cattaneo2011sulla}. It introduces a flux relaxation term to make the change of heat flux time dependent of the change in temperature. It's inconsistent with CIT but could be derived from the EIT approach. Here we begin with the entropy 
\begin{equation}
S(u,\mathbf{c})=S_{eq}(u)-\frac{1}{2\alpha_0} \mathbf{c}^2
\end{equation}

we have
\begin{equation}
\mathbf{q}=S_{\mathbf{c}}=-\frac{\mathbf{c}}{\alpha_0} \quad \theta^{-1}=T^{-1}=\frac{\partial S_{eq}(u)}{\partial u}
\end{equation}

The evolution equation for $\mathbf{c}$ is 
\begin{equation}
\mathbf{c}_t+\nabla T^{-1} =M\mathbf{q}
\end{equation}

And the evolution equation for $\mathbf{q}$ is
\begin{equation}
{\alpha_0}\mathbf{q}_t + M \mathbf{q} + \frac{1}{T^2} \nabla T=0
\end{equation}

If we choose $M=\frac{1}{\lambda T^2},\alpha_0=\frac{\tau}{\lambda T^2}$, we could have 
\begin{equation}
\tau \mathbf{q}_t + \lambda \nabla T+\mathbf{q}=0
\end{equation}
which is the Cattaneo's law.

From the derivation, we could see that our approach is direct and simple. One only need to follow the procedure described in the previous section. The system with Cattaneo's law could be written as
\begin{eqnarray}
\left( \begin{array}{ll} u \\ \mathbf{q} \end{array} \right)_t + \nabla \cdot \left( \begin{array}{ll} \mathbf{q} \\ \frac{\lambda}{\tau} T \end{array} \right) =\left( \begin{array}{ll} 0 \\ -\frac{\mathbf{q}}{\tau} \end{array} \right) 
\end{eqnarray}

As $\tau \rightarrow 0$, $\mathbf{q}+\lambda \nabla T=0$, which is the Fourier's law. The limit process could have a rigorous proof \cite{yong2008interesting}.
The derived equation is thus hyperbolic and follows the conservation-dissipation formalism. We could see that the dissipative variable $\mathbf{c}$ is proportional with the heat flux $\mathbf{q}$. So the quantity of  $\mathbf{q}$ measures the non-equilibrium of the system.

Now we will justify the concavity of the entropy $S=S(u,\mathbf{c})$. The Hessian matrix of $S$ is
\begin{eqnarray}
\left( \begin{array}{ll} -\frac{1}{c_v T^2} & 0 \\ 0 & -\frac{1}{\alpha_0} \end{array} \right)
\end{eqnarray}
where $c_v=\frac{d u}{d T}$.
The concavity of the entropy follows from the negative definite of the Hessian matrix which requires 
\begin{eqnarray}
\frac{1}{c_v T^2}>0 \\
\alpha_0=\frac{\tau}{\lambda T^2}>0
\end{eqnarray}
this requirements is consistent with the stability requirements obtained from EIT \cite{Jou1996extended}.

Here the generalized temperature $\theta$ is the same with the equilibrium temperature $T$. Since the non-equilibrium term $-\frac{1}{2\alpha_0}\mathbf{c}^2$ is independent of $u$, the change of internal energy has no influence on the local entropy production. The generalized temperature, defined by $\frac{\partial S}{\partial u}$ measures the local entropy production caused by the change of internal energy. Unlike in the EIT and RT, the generalized temperature is not responsible for the whole part of non-equilibrium states. The inverse of the temperature is defined to be the change of entropy with the change of the internal energy. Thus we have a consistent meaning of the temperature both in the equilibrium case and the non-equilibrium case.

\subsection{The generalized Cattaneo's law and the thermomass model}
In the Cattaneo's law the generalized temperature is the same with the equilibrium temperature and the local entropy production is not affected by the internal energy change. If we take the constant $\alpha_0$ to be dependent on the internal energy $u$ and we will get a new model, here we call it the generalized Cattaneo's law.
If we take
\begin{equation}
S(u,\mathbf{c})=S_{eq}(u)-\frac{1}{2\alpha(u)} \mathbf{c}^2
\end{equation}
we have 
\begin{equation}
\mathbf{q} = S_{\mathbf{c}}=-\frac{ \mathbf{c}}{\alpha(u)} \quad \theta^{-1}=S_u
\end{equation}

The evolution equation for $\mathbf{c}$ is 
\begin{equation}
\mathbf{c}_t+\nabla \theta^{-1}=M \mathbf{q}
\end{equation}

The evolution equation for $\mathbf{q}$ is
\begin{equation}\label{eq_theta}
({\alpha(u)}\mathbf{q})_t-\nabla \theta^{-1}+M\mathbf{q}=0
\end{equation}
We call it the generalized Cattaneo's law which differs from the classical Cattaneo's law in that the derivative for the derivatives of $\mathbf{q}$ is substituted with ${\alpha(u)}\mathbf{q}$.

If we use the equilibrium temperature $T$ instead of the non-equilibrium temperature $\theta$ we arrive at
\begin{equation}
\theta^{-1}=T^{-1}-\frac{1}{2}(\frac{1}{\alpha(u)})'\mathbf{c}^2
\end{equation}
where $T^{-1}=\frac{\partial S_{eq}(u)}{\partial u}$ and $u=C_v T$. And the derivative $'$ is respected with $u$.
and
\begin{equation}
\mathbf{c}_t+\nabla(T^{-1}-\frac{1}{2}(\frac{1}{\alpha(u)})' \mathbf{c}^2)=M\mathbf{q}
\end{equation}
or
\begin{equation}\label{eq_Teq}
({\alpha(u)}{\mathbf{q}})_t-\nabla(T^{-1}- \frac{\alpha'(u)\mathbf{q}^2}{2})+M\mathbf{q}=0
\end{equation}

Then we take $M=\frac{1}{\lambda T^2}, \alpha(u)=\frac{\rho C_v}{2\gamma u^3}=\frac{\rho}{2\gamma C_v^2 T^3}$
where $\rho$ is the density of the conduction material and $C_v$ is the heat capacity ratio.
We finally obtain
\begin{equation}
\tau_{TM} \mathbf{q}_t-3C_v \mathbf{L}T_t+3(\nabla \mathbf{q})^T \cdot \mathbf{L}+\lambda(1-6M_H^2)\nabla T+\mathbf{q}=0
\end{equation}
where
\begin{equation}
\tau_{TM}=\frac{\lambda \rho}{2 \gamma C_v^2 T} \quad \mathbf{L}=\frac{\lambda \rho}{2 \gamma C_v^3 T^2}\mathbf{q} \quad M_H^2=\frac{\lambda \rho \mathbf{q}^2}{2\gamma C_v^3 T^3}
\end{equation}

The thermomass model is 
\begin{equation}
\tau_{TM} \mathbf{q}_t-C_v \mathbf{L}T_t+\nabla \mathbf{q} \cdot \mathbf{L}+\lambda(1-M_H^2)\nabla T+\mathbf{q}=0
\end{equation}

The difference between our model and the thermomass model is the coefficient of the terms involving the spatial gradient of $\mathbf{q}$ and $T$.

Now we justify the concavity of the entropy. The Hessian matrix of $S(u,\mathbf{c})$ is
\begin{eqnarray}
\left( \begin{array}{ll} -\frac{1}{c_v T^2}-\frac{1}{2}(\frac{1}{\alpha(u)})'' \mathbf{c}^2 & (\frac{1}{\alpha})'\mathbf{c} \\ (\frac{1}{\alpha})'\mathbf{c} & -\frac{1}{\alpha(u)} \end{array} \right)
\end{eqnarray}
In order for the matrix to be positively definite, the diagonal components and the determinant should be negative. The first condition is satisfied under $c_v>0$, and the second condition gives
\begin{eqnarray}
\mathbf{q}=\alpha(u)\mathbf{c} \le \frac{\rho c_v T}{\sqrt{6}} \sqrt{\frac{\lambda}{\rho c_v \tau_{TM}}}
\end{eqnarray}
where $\sqrt{\frac{\lambda}{\rho c_v \tau_{TM}}}$ is the maximum speed of thermal waves \cite{Jou1996extended}. Then the concavity requirement is only satisfied under the critical heat flux.


From the example, we could see that the simple entropy form could lead to complex evolution equations for the heat flux. The evolution equation expressed in the generalized temperature \eqref{eq_theta} and in the equilibrium temperature \eqref{eq_Teq} has the same entropy form. The equation  \eqref{eq_theta} is similar with the Cattaneo's law but the coefficient of the $\mathbf{q}_t$ is depended on the internal energy $u$. And the temperature is generalized. \eqref{eq_Teq} gives the evolution equation under equilibrium temperature $T$. In our approach, the non-equilibrium of the system is described by the dissipative variables, which could be expressed as a function of the internal energy $u$ and the heat flux $\mathbf{q}$. So the definition of generalized temperature is clear and we just introduce it as a derived variable and not as a basic variable. Unlike many other theories like EIT takes the generalized temperature a central role in expressing the non-equilibrium, we takes the non-equilibrium variables the key factor to describe non-equilibrium.

We have established the connection between the thermomass model with the Cattaneo's law with this example.
\subsection{The Guyer-Krumhansl's model}
The Guyer-Krumhansl's model takes consideration of the gradient of the heat flux tensor. In order to include the spatial gradient of the flux tensor, we introduce an additional tensor $\mathbf{Q}$ in our dissipation variable. And the non-equilibrium variables for the system are $\mathbf{c}$ and $\mathbf{Q}$.We assume the tensor $\mathbf{Q}$ is symmetry and decompose the tensor $\mathbf{Q}=\mathring{\mathbf{Q}}+Q\mathbf{U}$, where $\mathbf{U}$ is the unit tensor and $tr(\mathring{\mathbf{Q}})=0$. Then we could take $w=\{\mathbf{c},\mathring{\mathbf{Q}},Q\}$.

Assume the entropy has the form
\begin{equation}
S(u,\mathbf{c},\mathring{\mathbf{Q}},Q)=S_{eq}(u)-\frac{1}{2 \alpha_0}\mathbf{c}^2-\frac{1}{2\tau_1} {\mathring{\mathbf{Q}}}:{\mathring{\mathbf{Q}}}-\frac{1}{2\tau_2}Q^2
\end{equation}

Then apply the calculation
\begin{eqnarray}
S_t &=& S_u u_t +S_{\mathbf{c}} \cdot \mathbf{c}_t + S_{\mathring{\mathbf{Q}}}:\mathring{\mathbf{Q}}_t+S_Q Q \\
    &=& -S_u \nabla \cdot \mathbf{q} + S_{\mathring{\mathbf{Q}}}:(\mathring{\mathbf{Q}})_t+S_QQ \\
    &=& -\nabla \cdot (S_u \mathbf{q}+\nabla (S_{\mathring{\mathbf{Q}}}+S_Q) \cdot \mathbf{q})+(\mathbf{c}_t+\nabla \cdot (S_{\mathring{\mathbf{Q}}}+S_Q)+\nabla S_u) \cdot \mathbf{q} \\
&& +S_{\mathring{\mathbf{Q}}}:(\mathring{\mathbf{Q}}_t+(\mathring{\nabla \mathbf{q}})^{sym})+S_Q(Q_t+\frac{1}{3}\nabla \cdot \mathbf{q})
\end{eqnarray}

To guarantee the positiveness of the local entropy production we follow from the conservation-dissipation structure.
\begin{equation}
\left( \begin{array}{ll} \mathbf{c}_t+\nabla \cdot (S_{\mathring{\mathbf{Q}}}+S_Q)+\nabla S_u \\ \mathring{\mathbf{Q}}_t+(\mathring{\nabla \mathbf{q}})^{sym} \\ Q_t+\frac{1}{3} \nabla \cdot \mathbf{q} \end{array} \right) = M \left( \begin{array}{l} \mathbf{q} \\ S_{\mathring{\mathbf{Q}}} \\S_Q \end{array} \right) 
\end{equation}

If we take $M$ to be 
\begin{equation}
M=\left( \begin{array}{lll} M_0 & 0 & 0 \\0 & M_1 & 0 \\0 & 0 & M_2 \end{array} \right)
\end{equation}
We have
\begin{eqnarray}
\mathring{\mathbf{Q}}_t+(\mathring{\nabla \mathbf{q}})^{sym}=-\frac{M_1}{\tau_1}\mathring{\mathbf{Q}} \\
Q_t+\frac{1}{3} \nabla \cdot \mathbf{q}=-\frac{M_2}{\tau_2}Q
\end{eqnarray}

When $\tau_1 \to 0, \tau_2 \to 0$, it reduces to
\begin{eqnarray} 
\mathring{\mathbf{Q}}=-\frac{\tau_1}{M_1}(\mathring{\nabla \mathbf{q}})^{sym} \quad  or \quad \mathring{S}_\mathbf{Q}=\frac{1}{M_1}(\mathring{\nabla \mathbf{q}})^{sym} \\
Q=-\frac{\tau_2}{3M_2}\nabla \cdot \mathbf{q} \quad or \quad \bar{S}_\mathbf{Q}=\frac{1}{3M_2} \nabla \cdot \mathbf{q}
\end{eqnarray}

Taking $M$ as
\begin{equation}
M_0=\frac{1}{\lambda T^2}, M_1=\frac{\lambda T^2}{d\tau}, M_2=\frac{2\lambda T^2}{5d\tau}
\end{equation}
and $\alpha_0=\frac{\tau}{\lambda T^2}$,
we arrive at the Guyer-Krumhansl's model \cite{Jou1996extended}
\begin{equation}
\mathbf{q}_t+\frac{\mathbf{q}}{\tau}+\frac{\lambda}{\tau}\nabla T=\frac{1}{2}d(\nabla^2 \mathbf{q}+2\nabla \nabla \cdot \mathbf{q})
\end{equation}
Notice that $\lambda, \tau$ may depend on $T$ but $d$ is a constant.

Since we have applied a limit process, the obtained model is the relaxation of hyperbolic partial differential equations. the GK model is of second parabolic. And if we choose $\tau_1,\tau_2$ not to be very small, then the evolution equations will be hyperbolic, leading to a generalized GK model.
\begin{eqnarray}
\alpha_0 \mathbf{q}_t - \nabla \cdot ({\frac{1}{\tau_1} \mathring{\mathbf{Q}}}+\frac{1}{\tau_2}Q)+\nabla T^{-1} = M_0 \mathbf{q} \\
\mathring{\mathbf{Q}}_t+(\mathring{\nabla \mathbf{q}})^{sym}=-\frac{M_1}{\tau_1}\mathring{\mathbf{Q}} \\
Q_t+\frac{1}{3} \nabla \cdot \mathbf{q}=-\frac{M_2}{\tau_2}Q
\end{eqnarray}

The Hessian matrix of the entropy is 
\begin{eqnarray}
\left(\begin{array}{llll}  -\frac{1}{c_v T^2} & 0 & 0 & 0 \\
                                           0  & -\frac{1}{\alpha_0} & 0 & 0 \\
										   0 & 0 & -\frac{1}{2\tau_1} & 0 \\
										   0 & 0 & 0 & -\frac{1}{2\tau_2}
										   \end{array} \right)
\end{eqnarray}
The concavity requirement follows from the requirement of the relaxation parameter $\tau,\tau_1,\tau_2$ and $c_v$.

\section{Conclusion and discussion}
In this work, the conservation-dissipation formalism of non-equilibrium thermodynamics is used to develop a unified approach for the heat transfer modeling. The procedure of heat transfer modeling with our approach is provided. The conservation-dissipation formalism is responsible for the well-posedness of the derived equations and is mathematical reasonable. The equations we obtained is hyperbolic and follows the structure in Yong's paper.\cite{yong2008interesting} We put the heat transfer modeling with a solid mathematical base as well as a physical insight. The non-equilibrium variables are introduced in our approach to describe how far the system goes beyond equilibrium. Our approach is useful near equilibrium as well as far from the equilibrium. Two temperature is defined, the equilibrium temperature and the generalized temperature. The two temperatures both measure the change of local entropy production with respect to the internal energy. 

In our approach, we begin with the concrete form of the entropy and follow the same procedure to get the different model. Here we take the conjugate variable of $\mathbf{q}$ as the non-equilibrium variable in our derivation. And in order to take the spatial gradient into consideration we introduce a tensor $\mathbf{Q}$ which is conjugate with $\nabla \mathbf{q}$ as the non-equilibrium variable. The quadratic entropy form is used to get the different models. However one should notice that it's not necessary to make the quadratic form assumption of the entropy. We could take arbitrary concave function. After the entropy form is assumed, we write the local entropy production into the entropy flux term and the local entropy production term. To guarantee the positiveness of the local entropy production we choose the matrix $M$ to be positively defined. The final model is thus obtained. The model by our approach follows the conservation-dissipation form and could be written as a system of hyperbolic conservation equations with source terms. In physics, the model satisfies the second law of thermodynamics automatically, we don't need to examine the positiveness of the local entropy production.

The limit process of relaxation parameters could be seen as the hyperbolic partial differential equations with small parameter. The hyperbolic relaxation problem has been studied by many mathematicians \cite{yong2001basic,chen1994hyperbolic}. With our approach, we could put the limit process with a rigorous mathematical theory. We will discuss it in the future publications.


\bibliography{heat}{}
\bibliographystyle{plain}
\end{document}